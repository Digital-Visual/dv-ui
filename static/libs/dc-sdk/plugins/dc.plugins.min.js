!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)}([function(e,t){e.exports="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform float frequency;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n  vec2 F = czm_cellular(materialInput.st * frequency);\n  float t = 1.0 - F.x * F.x;\n\n  vec4 color = mix(lightColor, darkColor, t);\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t,n){e.exports=n(2)},function(e,t,n){var r;r=!1,DC||console.error("missing dc sdk"),DC.getNamespace().mapv=window.mapv||void 0,delete window.mapv,DC.init((function(){!r&&n(26),r=!0}))},function(e,t){e.exports="uniform vec4 color;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec4 fragColor = color;\n    fragColor = czm_gammaCorrect(fragColor);\n    material.emission = fragColor.rgb;\n    material.diffuse = fragColor.rgb;\n    material.alpha = color.a;\n    return material;\n}\n"},function(e,t){e.exports="uniform vec4 color;\nuniform float duration;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec2 st = materialInput.st;\n    float t =fract(czm_frameNumber / duration);\n    t *= 1.03;\n    float alpha = smoothstep(t- 0.03, t, st.s) * step(-t, -st.s);\n    alpha += 0.1;\n    material.diffuse = color.rgb;\n    material.alpha = alpha;\n    return material;\n}\n"},function(e,t){e.exports=" uniform sampler2D image;\n uniform float duration;\n uniform vec4 color;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n   czm_material material = czm_getDefaultMaterial(materialInput);\n   vec2 st = materialInput.st;\n   float time = fract(czm_frameNumber / duration);\n   vec4 colorImage = texture2D(image, vec2(fract(st.s - time), st.t));\n   material.alpha = colorImage.a * color.a;\n   material.diffuse = (colorImage.rgb + color.rgb)/2.0;\n   return material;\n}\n"},function(e,t){e.exports='/**\n * @license\n * Cellular noise ("Worley noise") in 2D in GLSL.\n * Copyright (c) Stefan Gustavson 2011-04-19. All rights reserved.\n * This code is released under the conditions of the MIT license.\n * See LICENSE file for details.\n */\n\n//#ifdef GL_OES_standard_derivatives\n//    #extension GL_OES_standard_derivatives : enable\n//#endif\n//\n//float aastep (float threshold , float value)\n//{\n//    float afwidth = 0.7 * length ( vec2 ( dFdx ( value ), dFdy ( value )));\n//    return smoothstep ( threshold - afwidth , threshold + afwidth , value );\n//}\n\n// Permutation polynomial: (34x^2 + x) mod 289\nvec3 _czm_permute289(vec3 x)\n{\n    return mod((34.0 * x + 1.0) * x, 289.0);\n}\n\n/**\n * DOC_TBA\n *\n * Implemented by Stefan Gustavson, and distributed under the MIT License.  {@link http://openglinsights.git.sourceforge.net/git/gitweb.cgi?p=openglinsights/openglinsights;a=tree;f=proceduraltextures}\n *\n * @name czm_cellular\n * @glslFunction\n *\n * @see Stefan Gustavson\'s chapter, <i>Procedural Textures in GLSL</i>, in <a href="http://www.openglinsights.com/">OpenGL Insights</a>.\n */\nvec2 czm_cellular(vec2 P)\n// Cellular noise, returning F1 and F2 in a vec2.\n// Standard 3x3 search window for good F1 and F2 values\n{\n#define K 0.142857142857 // 1/7\n#define Ko 0.428571428571 // 3/7\n#define jitter 1.0 // Less gives more regular pattern\n    vec2 Pi = mod(floor(P), 289.0);\n    vec2 Pf = fract(P);\n    vec3 oi = vec3(-1.0, 0.0, 1.0);\n    vec3 of = vec3(-0.5, 0.5, 1.5);\n    vec3 px = _czm_permute289(Pi.x + oi);\n    vec3 p = _czm_permute289(px.x + Pi.y + oi); // p11, p12, p13\n    vec3 ox = fract(p*K) - Ko;\n    vec3 oy = mod(floor(p*K),7.0)*K - Ko;\n    vec3 dx = Pf.x + 0.5 + jitter*ox;\n    vec3 dy = Pf.y - of + jitter*oy;\n    vec3 d1 = dx * dx + dy * dy; // d11, d12 and d13, squared\n    p = _czm_permute289(px.y + Pi.y + oi); // p21, p22, p23\n    ox = fract(p*K) - Ko;\n    oy = mod(floor(p*K),7.0)*K - Ko;\n    dx = Pf.x - 0.5 + jitter*ox;\n    dy = Pf.y - of + jitter*oy;\n    vec3 d2 = dx * dx + dy * dy; // d21, d22 and d23, squared\n    p = _czm_permute289(px.z + Pi.y + oi); // p31, p32, p33\n    ox = fract(p*K) - Ko;\n    oy = mod(floor(p*K),7.0)*K - Ko;\n    dx = Pf.x - 1.5 + jitter*ox;\n    dy = Pf.y - of + jitter*oy;\n    vec3 d3 = dx * dx + dy * dy; // d31, d32 and d33, squared\n    // Sort out the two smallest distances (F1, F2)\n    vec3 d1a = min(d1, d2);\n    d2 = max(d1, d2); // Swap to keep candidates for F2\n    d2 = min(d2, d3); // neither F1 nor F2 are now in d3\n    d1 = min(d1a, d2); // F1 is now in d1\n    d2 = max(d1a, d2); // Swap to keep candidates for F2\n    d1.xy = (d1.x < d1.y) ? d1.xy : d1.yx; // Swap if smaller\n    d1.xz = (d1.x < d1.z) ? d1.xz : d1.zx; // F1 is in d1.x\n    d1.yz = min(d1.yz, d2.yz); // F2 is now not in d2.yz\n    d1.y = min(d1.y, d1.z); // nor in  d1.z\n    d1.y = min(d1.y, d2.x); // F2 is in d1.y, we\'re done.\n    return sqrt(d1.xy);\n}\n'},function(e,t){e.exports='/**\n * @license\n * Description : Array and textureless GLSL 2D/3D/4D simplex\n *               noise functions.\n *      Author : Ian McEwan, Ashima Arts.\n *  Maintainer : ijm\n *     Lastmod : 20110822 (ijm)\n *     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n *               Distributed under the MIT License. See LICENSE file.\n *               https://github.com/ashima/webgl-noise\n */\n\nvec4 _czm_mod289(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 _czm_mod289(vec3 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 _czm_mod289(vec2 x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat _czm_mod289(float x)\n{\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 _czm_permute(vec4 x)\n{\n    return _czm_mod289(((x*34.0)+1.0)*x);\n}\n\nvec3 _czm_permute(vec3 x)\n{\n    return _czm_mod289(((x*34.0)+1.0)*x);\n}\n\nfloat _czm_permute(float x)\n{\n    return _czm_mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 _czm_taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat _czm_taylorInvSqrt(float r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 _czm_grad4(float j, vec4 ip)\n{\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n/**\n * DOC_TBA\n *\n * Implemented by Ian McEwan, Ashima Arts, and distributed under the MIT License.  {@link https://github.com/ashima/webgl-noise}\n *\n * @name czm_snoise\n * @glslFunction\n *\n * @see <a href="https://github.com/ashima/webgl-noise">https://github.com/ashima/webgl-noise</a>\n * @see Stefan Gustavson\'s paper <a href="http://www.itn.liu.se/~stegu/simplexnoise/simplexnoise.pdf">Simplex noise demystified</a>\n */\nfloat czm_snoise(vec2 v)\n{\n    const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                        0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                       -0.577350269189626,  // -1.0 + 2.0 * C.x\n                        0.024390243902439); // 1.0 / 41.0\n    // First corner\n    vec2 i  = floor(v + dot(v, C.yy) );\n    vec2 x0 = v -   i + dot(i, C.xx);\n\n    // Other corners\n    vec2 i1;\n    //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n    //i1.y = 1.0 - i1.x;\n    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n    // x0 = x0 - 0.0 + 0.0 * C.xx ;\n    // x1 = x0 - i1 + 1.0 * C.xx ;\n    // x2 = x0 - 1.0 + 2.0 * C.xx ;\n    vec4 x12 = x0.xyxy + C.xxzz;\n    x12.xy -= i1;\n\n    // Permutations\n    i = _czm_mod289(i); // Avoid truncation effects in permutation\n    vec3 p = _czm_permute( _czm_permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));\n\n    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n    m = m*m ;\n    m = m*m ;\n\n    // Gradients: 41 points uniformly over a line, mapped onto a diamond.\n    // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n    vec3 x = 2.0 * fract(p * C.www) - 1.0;\n    vec3 h = abs(x) - 0.5;\n    vec3 ox = floor(x + 0.5);\n    vec3 a0 = x - ox;\n\n    // Normalise gradients implicitly by scaling m\n    // Approximation of: m *= inversesqrt( a0*a0 + h*h );\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n    // Compute final noise value at P\n    vec3 g;\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\n    g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n    return 130.0 * dot(m, g);\n}\n\nfloat czm_snoise(vec3 v)\n{\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n    // First corner\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n    // Other corners\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n\n    //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n    //   x1 = x0 - i1  + 1.0 * C.xxx;\n    //   x2 = x0 - i2  + 2.0 * C.xxx;\n    //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n    // Permutations\n    i = _czm_mod289(i);\n    vec4 p = _czm_permute( _czm_permute( _czm_permute(\n                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n\n    //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n    //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n\n    //Normalise gradients\n    vec4 norm = _czm_taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat czm_snoise(vec4 v)\n{\n    const vec4  C = vec4( 0.138196601125011,  // (5 - sqrt(5))/20  G4\n                          0.276393202250021,  // 2 * G4\n                          0.414589803375032,  // 3 * G4\n                         -0.447213595499958); // -1 + 4 * G4\n\n    // (sqrt(5) - 1)/4 = F4, used once below\n    #define F4 0.309016994374947451\n\n    // First corner\n    vec4 i  = floor(v + dot(v, vec4(F4)) );\n    vec4 x0 = v -   i + dot(i, C.xxxx);\n\n    // Other corners\n\n    // Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    //  i0.x = dot( isX, vec3( 1.0 ) );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    //  i0.y += dot( isYZ.xy, vec2( 1.0 ) );\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    // i0 now contains the unique values 0,1,2,3 in each channel\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    //  x0 = x0 - 0.0 + 0.0 * C.xxxx\n    //  x1 = x0 - i1  + 1.0 * C.xxxx\n    //  x2 = x0 - i2  + 2.0 * C.xxxx\n    //  x3 = x0 - i3  + 3.0 * C.xxxx\n    //  x4 = x0 - 1.0 + 4.0 * C.xxxx\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    // Permutations\n    i = _czm_mod289(i);\n    float j0 = _czm_permute( _czm_permute( _czm_permute( _czm_permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = _czm_permute( _czm_permute( _czm_permute( _czm_permute (\n               i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n             + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n             + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n             + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n    // Gradients: 7x7x6 points over a cube, mapped onto a 4-cross polytope\n    // 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = _czm_grad4(j0,   ip);\n    vec4 p1 = _czm_grad4(j1.x, ip);\n    vec4 p2 = _czm_grad4(j1.y, ip);\n    vec4 p3 = _czm_grad4(j1.z, ip);\n    vec4 p4 = _czm_grad4(j1.w, ip);\n\n    // Normalise gradients\n    vec4 norm = _czm_taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= _czm_taylorInvSqrt(dot(p4,p4));\n\n    // Mix contributions from the five corners\n    vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);\n    vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);\n    m0 = m0 * m0;\n    m1 = m1 * m1;\n    return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 )))\n                  + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;\n}\n'},function(e,t){e.exports="uniform vec4 asphaltColor;\nuniform float bumpSize;\nuniform float roughness;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n  //Main cellular pattern\n  vec4 color = asphaltColor;\n  vec2 st = materialInput.st;\n  vec2 F = czm_cellular(st / bumpSize);\n  color.rgb -= (F.x / F.y) * 0.1;\n\n  //Extra bumps for roughness\n  float noise = czm_snoise(st / bumpSize);\n  noise = pow(noise, 5.0) * roughness;\n  color.rgb += noise;\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 cementColor;\nuniform float grainScale;\nuniform float roughness;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  float noise = czm_snoise(materialInput.st / grainScale);\n  noise = pow(noise, 5.0) * roughness;\n\n  vec4 color = cementColor;\n  color.rgb += noise;\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 color;\nuniform float time;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  float alpha = 1.0;\n  if (time != 1.0)\n  {\n      float t = 0.5 + (0.5 * czm_snoise(materialInput.str / (1.0 / 10.0)));   // Scale [-1, 1] to [0, 1]\n\n      if (t > time)\n      {\n          alpha = 0.0;\n      }\n  }\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a * alpha;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform float frequency;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n  vec2 F = czm_cellular(materialInput.st * frequency);\n  float t = 0.1 + (F.y - F.x);\n\n  vec4 color = mix(lightColor, darkColor, t);\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="czm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec3 normalWC = normalize(czm_inverseViewRotation * material.normal);\n  vec3 positionWC = normalize(czm_inverseViewRotation * materialInput.positionToEyeEC);\n  float cosAngIncidence = max(dot(normalWC, positionWC), 0.0);\n\n  material.diffuse = mix(reflection.diffuse, refraction.diffuse, cosAngIncidence);\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 grassColor;\nuniform vec4 dirtColor;\nuniform float patchiness;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec2 st = materialInput.st;\n  float noise1 = (czm_snoise(st * patchiness * 1.0)) * 1.0;\n  float noise2 = (czm_snoise(st * patchiness * 2.0)) * 0.5;\n  float noise3 = (czm_snoise(st * patchiness * 4.0)) * 0.25;\n  float noise = sin(noise1 + noise2 + noise3) * 0.1;\n\n  vec4 color = mix(grassColor, dirtColor, noise);\n\n  //Make thatch patterns\n  float verticalNoise = czm_snoise(vec2(st.x * 100.0, st.y * 20.0)) * 0.02;\n  float horizontalNoise = czm_snoise(vec2(st.x * 20.0, st.y * 100.0)) * 0.02;\n  float stripeNoise = min(verticalNoise, horizontalNoise);\n\n  color.rgb += stripeNoise;\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform samplerCube cubeMap;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec3 normalWC = normalize(czm_inverseViewRotation * material.normal);\n  vec3 positionWC = normalize(czm_inverseViewRotation * materialInput.positionToEyeEC);\n  vec3 reflectedWC = reflect(positionWC, normalWC);\n  material.diffuse = textureCube(cubeMap, reflectedWC).channels;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform samplerCube cubeMap;\nuniform float indexOfRefractionRatio;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec3 normalWC = normalize(czm_inverseViewRotation * material.normal);\n  vec3 positionWC = normalize(czm_inverseViewRotation * materialInput.positionToEyeEC);\n  vec3 refractedWC = refract(positionWC, -normalWC, indexOfRefractionRatio);\n  material.diffuse = textureCube(cubeMap, refractedWC).channels;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform float frequency;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  vec3 scaled = materialInput.str * frequency;\n  float t = abs(czm_snoise(scaled));\n\n  vec4 color = mix(lightColor, darkColor, t);\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 lightWoodColor;\nuniform vec4 darkWoodColor;\nuniform float ringFrequency;\nuniform vec2 noiseScale;\nuniform float grainFrequency;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n\n  //Based on wood shader from OpenGL Shading Language (3rd edition) pg. 455\n  vec2 st = materialInput.st;\n\n  vec2 noisevec;\n  noisevec.x = czm_snoise(st * noiseScale.x);\n  noisevec.y = czm_snoise(st * noiseScale.y);\n\n  vec2 location = st + noisevec;\n  float dist = sqrt(location.x * location.x + location.y * location.y);\n  dist *= ringFrequency;\n\n  float r = fract(dist + noisevec[0] + noisevec[1]) * 2.0;\n  if(r > 1.0)\n      r = 2.0 - r;\n\n  vec4 color = mix(lightWoodColor, darkWoodColor, r);\n\n  //streaks\n  r = abs(czm_snoise(vec2(st.x * grainFrequency, st.y * grainFrequency * 0.02))) * 0.2;\n  color.rgb += lightWoodColor.rgb * r;\n\n  material.diffuse = color.rgb;\n  material.alpha = color.a;\n\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 color;\nuniform float duration;\n\nczm_material czm_getMaterial(czm_materialInput materialInput){\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  material.diffuse = 1.5 * color.rgb;\n  vec2 st = materialInput.st;\n  float dis = distance(st, vec2(0.5, 0.5));\n  float per = fract(czm_frameNumber / duration);\n  if(dis > per * 0.5){\n   discard;\n  }else {\n    material.alpha = color.a  * dis / per / 2.0;\n  }\n  return material;\n}\n"},function(e,t){e.exports="uniform vec4 color;\nuniform float duration;\nuniform float count;\nuniform float gradient;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n  czm_material material = czm_getDefaultMaterial(materialInput);\n  material.diffuse = 1.5 * color.rgb;\n  vec2 st = materialInput.st;\n  vec3 str = materialInput.str;\n  float dis = distance(st, vec2(0.5, 0.5));\n  float per = fract(czm_frameNumber / duration);\n  if(abs(str.z)>0.001){\n    discard;\n  }\n  if(dis >0.5){\n    discard;\n  }else {\n    float perDis = 0.5 / count;\n    float disNum;\n    float bl = .0;\n    for(int i=0;i<=10;i++){\n      if(float(i)<=count){\n        disNum = perDis*float(i) - dis + per/count;\n        if(disNum>0.0){\n          if(disNum<perDis){\n            bl = 1.0-disNum/perDis;\n          }else if(disNum-perDis<perDis){\n            bl = 1.0 - abs(1.0-disNum/perDis);\n          }\n          material.alpha = pow(bl,gradient);\n        }\n      }\n    }\n  }\n  return material;\n}\n`s\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nuniform vec4 u_scanCenterEC;\nuniform vec3 u_scanPlaneNormalEC;\nuniform float u_radius;\nuniform vec4 u_scanColor;\n\nvec4 toEye(in vec2 uv, in float depth){\n  vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n  vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n  posInCamera =posInCamera / posInCamera.w;\n  return posInCamera;\n}\n\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point){\n    vec3 v01 = point - planeOrigin;\n    float d = dot(planeNormal, v01) ;\n    return (point - planeNormal * d);\n}\n\nfloat getDepth(in vec4 depth){\n    float z_window = czm_unpackDepth(depth);\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\n\nvoid main(){\n    gl_FragColor = texture2D(colorTexture, v_textureCoordinates);\n    float depth = getDepth(texture2D(depthTexture, v_textureCoordinates));\n    vec4 viewPos = toEye(v_textureCoordinates, depth);\n    vec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\n    float dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\n    if(dis < u_radius){\n      float f = 1.0 - abs(u_radius - dis) / u_radius;\n      f = pow(f, 4.0);\n      gl_FragColor = mix(gl_FragColor, u_scanColor, f);\n    }\n  }\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nuniform vec4 u_scanCenterEC;\nuniform vec3 u_scanPlaneNormalEC;\nuniform vec3 u_scanLineNormalEC;\nuniform float u_radius;\nuniform vec4 u_scanColor;\n\nvec4 toEye(in vec2 uv, in float depth){\n  vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n  vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n  posInCamera =posInCamera / posInCamera.w;\n  return posInCamera;\n}\n\nbool isPointOnLineRight(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt){\n  vec3 v01 = testPt - ptOnLine;\n  normalize(v01);\n  vec3 temp = cross(v01, lineNormal);\n  float d = dot(temp, u_scanPlaneNormalEC);\n  return d > 0.5;\n}\n\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point){\n  vec3 v01 = point -planeOrigin;\n  float d = dot(planeNormal, v01) ;\n  return (point - planeNormal * d);\n}\n\nfloat distancePointToLine(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt){\n  vec3 tempPt = pointProjectOnPlane(lineNormal, ptOnLine, testPt);\n  return length(tempPt - ptOnLine);\n}\n\nfloat getDepth(in vec4 depth){\n  float z_window = czm_unpackDepth(depth);\n  z_window = czm_reverseLogDepth(z_window);\n  float n_range = czm_depthRange.near;\n  float f_range = czm_depthRange.far;\n  return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\n\nvoid main(){\n  gl_FragColor = texture2D(colorTexture, v_textureCoordinates);\n  float depth = getDepth( texture2D(depthTexture, v_textureCoordinates));\n  vec4 viewPos = toEye(v_textureCoordinates, depth);\n  vec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\n  float dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\n  float twou_radius = u_radius * 2.0;\n  if(dis < u_radius){\n      float f0 = 1.0 -abs(u_radius - dis) / u_radius;\n      f0 = pow(f0, 64.0);\n      vec3 lineEndPt = vec3(u_scanCenterEC.xyz) + u_scanLineNormalEC * u_radius;\n      float f = 0.0;\n      if(isPointOnLineRight(u_scanCenterEC.xyz, u_scanLineNormalEC.xyz, prjOnPlane.xyz)){\n          float dis1= length(prjOnPlane.xyz - lineEndPt);\n          f = abs(twou_radius -dis1) / twou_radius;\n          f = pow(f, 3.0);\n      }\n      gl_FragColor = mix(gl_FragColor, u_scanColor, f + f0);\n    }\n}\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform float trength;\nuniform vec4 fogcolor;\nvarying vec2 v_textureCoordinates;\n\nvoid main(void){\n  vec4 origcolor = texture2D(colorTexture, v_textureCoordinates);\n  float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n  vec4 depthcolor = texture2D(depthTexture, v_textureCoordinates);\n  float f= clamp( trength * (depthcolor.r - 0.3 ) / 0.2, 0, 1)\n  gl_FragColor = mix(origcolor,fogcolor,f);\n}\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\n\nfloat snow(vec2 uv,float scale){\n    float time = czm_frameNumber / 60.0;\n    float w=smoothstep(1.,0.,-uv.y*(scale/10.));\n    if(w<.1)return 0.;\n    uv+=time/scale;\n    uv.y+=time*2./scale;\n    uv.x+=sin(uv.y+time*.5)/scale;\n    uv*=scale;\n    vec2 s=floor(uv),f=fract(uv),p;\n    float k=3.,d;\n    p=.5+.35*sin(11.*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.))-f;\n    d=length(p);\n    k=min(d,k);\n    k=smoothstep(0.,k,sin(f.x+f.y)*0.01);\n    return k*w;\n}\n\nvoid main(){\n    vec2 resolution = czm_viewport.zw;\n    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n    vec3 finalColor=vec3(0);\n    float c = 0.0;\n    c+=snow(uv,30.)*.0;\n    c+=snow(uv,20.)*.0;\n    c+=snow(uv,15.)*.0;\n    c+=snow(uv,10.);\n    c+=snow(uv,8.);\n    c+=snow(uv,6.);\n    c+=snow(uv,5.);\n    finalColor=(vec3(c));\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(finalColor,1), 0.3);\n\n}\n\n"},function(e,t){e.exports="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\n\nfloat hash(float x){\n  return fract(sin(x*23.3)*13.13);\n}\n\nvoid main(){\n    float time = czm_frameNumber / 60.0;\n    vec2 resolution = czm_viewport.zw;\n    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n    vec3 c=vec3(.6,.7,.8);\n    float a=-.4;\n    float si=sin(a),co=cos(a);\n    uv*=mat2(co,-si,si,co);\n    uv*=length(uv+vec2(0,4.9))*.3+1.;\n    float v=1.-sin(hash(floor(uv.x*100.))*2.);\n    float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;\n    c*=v*b;\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5);\n}\n"},function(e,t,n){var r,i;!function(o,a,s){e.exports?e.exports=s():void 0===(i="function"==typeof(r=s)?r.call(t,n,t,e):r)||(e.exports=i)}(0,0,(function(){var e={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},t=function(){var t=function(e){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=e.xField||e.defaultXField,this._yField=e.yField||e.defaultYField,this._valueField=e.valueField||e.defaultValueField,e.radius&&(this._cfgRadius=e.radius)},n=e.defaultRadius;return t.prototype={_organiseData:function(e,t){var r=e[this._xField],i=e[this._yField],o=this._radi,a=this._data,s=this._max,l=this._min,c=e[this._valueField]||1,u=e.radius||this._cfgRadius||n;a[r]||(a[r]=[],o[r]=[]),a[r][i]?a[r][i]+=c:(a[r][i]=c,o[r][i]=u);var f=a[r][i];return f>s?(t?this.setDataMax(f):this._max=f,!1):f<l?(t?this.setDataMin(f):this._min=f,!1):{x:r,y:i,value:c,radius:u,min:l,max:s}},_unOrganizeData:function(){var e=[],t=this._data,n=this._radi;for(var r in t)for(var i in t[r])e.push({x:r,y:i,radius:n[r][i],value:t[r][i]});return{min:this._min,max:this._max,data:e}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var e=arguments[0],t=e.length;t--;)this.addData.call(this,e[t]);else{var n=this._organiseData(arguments[0],!0);n&&(0===this._data.length&&(this._min=this._max=n.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[n]}))}return this},setData:function(e){var t=e.data,n=t.length;this._data=[],this._radi=[];for(var r=0;r<n;r++)this._organiseData(t[r],!1);return this._max=e.max,this._min=e.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(e){return this._max=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(e){return this._min=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(e){this._coordinator=e},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),n=function(){var e=function(e){var t=e.gradient||e.defaultGradient,n=document.createElement("canvas"),r=n.getContext("2d");n.width=256,n.height=1;var i=r.createLinearGradient(0,0,256,1);for(var o in t)i.addColorStop(o,t[o]);return r.fillStyle=i,r.fillRect(0,0,256,1),r.getImageData(0,0,256,1).data},t=function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d"),i=e,o=e;if(n.width=n.height=2*e,1==t)r.beginPath(),r.arc(i,o,e,0,2*Math.PI,!1),r.fillStyle="rgba(0,0,0,1)",r.fill();else{var a=r.createRadialGradient(i,o,e*t,i,o,e);a.addColorStop(0,"rgba(0,0,0,1)"),a.addColorStop(1,"rgba(0,0,0,0)"),r.fillStyle=a,r.fillRect(0,0,2*e,2*e)}return n};function n(t){var n=t.container,r=this.shadowCanvas=document.createElement("canvas"),i=this.canvas=t.canvas||document.createElement("canvas"),o=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});i.className="heatmap-canvas",this._width=i.width=r.width=t.width||+o.width.replace(/px/,""),this._height=i.height=r.height=t.height||+o.height.replace(/px/,""),this.shadowCtx=r.getContext("2d"),this.ctx=i.getContext("2d"),i.style.cssText=r.style.cssText="position:absolute;left:0;top:0;",n.style.position="relative",n.appendChild(i),this._palette=e(t),this._templates={},this._setStyles(t)}return n.prototype={renderPartial:function(e){e.data.length>0&&(this._drawAlpha(e),this._colorize())},renderAll:function(e){this._clear(),e.data.length>0&&(this._drawAlpha(function(e){for(var t=[],n=e.min,r=e.max,i=e.radi,o=(e=e.data,Object.keys(e)),a=o.length;a--;)for(var s=o[a],l=Object.keys(e[s]),c=l.length;c--;){var u=l[c],f=e[s][u],p=i[s][u];t.push({x:s,y:u,value:f,radius:p})}return{min:n,max:r,data:t}}(e)),this._colorize())},_updateGradient:function(t){this._palette=e(t)},updateConfig:function(e){e.gradient&&this._updateGradient(e),this._setStyles(e)},setDimensions:function(e,t){this._width=e,this._height=t,this.canvas.width=this.shadowCanvas.width=e,this.canvas.height=this.shadowCanvas.height=t},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(e){this._blur=0==e.blur?0:e.blur||e.defaultBlur,e.backgroundColor&&(this.canvas.style.backgroundColor=e.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=e.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=e.height||this._height,this._opacity=255*(e.opacity||0),this._maxOpacity=255*(e.maxOpacity||e.defaultMaxOpacity),this._minOpacity=255*(e.minOpacity||e.defaultMinOpacity),this._useGradientOpacity=!!e.useGradientOpacity},_drawAlpha:function(e){for(var n=this._min=e.min,r=this._max=e.max,i=(e=e.data||[]).length,o=1-this._blur;i--;){var a,s=e[i],l=s.x,c=s.y,u=s.radius,f=Math.min(s.value,r),p=l-u,h=c-u,y=this.shadowCtx;this._templates[u]?a=this._templates[u]:this._templates[u]=a=t(u,o);var d=(f-n)/(r-n);y.globalAlpha=d<.01?.01:d,y.drawImage(a,p,h),p<this._renderBoundaries[0]&&(this._renderBoundaries[0]=p),h<this._renderBoundaries[1]&&(this._renderBoundaries[1]=h),p+2*u>this._renderBoundaries[2]&&(this._renderBoundaries[2]=p+2*u),h+2*u>this._renderBoundaries[3]&&(this._renderBoundaries[3]=h+2*u)}},_colorize:function(){var e=this._renderBoundaries[0],t=this._renderBoundaries[1],n=this._renderBoundaries[2]-e,r=this._renderBoundaries[3]-t,i=this._width,o=this._height,a=this._opacity,s=this._maxOpacity,l=this._minOpacity,c=this._useGradientOpacity;e<0&&(e=0),t<0&&(t=0),e+n>i&&(n=i-e),t+r>o&&(r=o-t);for(var u=this.shadowCtx.getImageData(e,t,n,r),f=u.data,p=f.length,h=this._palette,y=3;y<p;y+=4){var d,_=f[y],m=4*_;if(m)d=a>0?a:_<s?_<l?l:_:s,f[y-3]=h[m],f[y-2]=h[m+1],f[y-1]=h[m+2],f[y]=c?h[m+3]:d}u.data=f,this.ctx.putImageData(u,e,t),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(e){var t=this.shadowCtx.getImageData(e.x,e.y,1,1).data[3],n=this._max,r=this._min;return Math.abs(n-r)*(t/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},n}(),r=function(){var t=!1;return"canvas2d"===e.defaultRenderer&&(t=n),t}(),i=function(){for(var e={},t=arguments.length,n=0;n<t;n++){var r=arguments[n];for(var i in r)e[i]=r[i]}return e},o=function(){var n=function(){function e(){this.cStore={}}return e.prototype={on:function(e,t,n){var r=this.cStore;r[e]||(r[e]=[]),r[e].push((function(e){return t.call(n,e)}))},emit:function(e,t){var n=this.cStore;if(n[e])for(var r=n[e].length,i=0;i<r;i++){(0,n[e][i])(t)}}},e}(),o=function(e){var t=e._renderer,n=e._coordinator,r=e._store;n.on("renderpartial",t.renderPartial,t),n.on("renderall",t.renderAll,t),n.on("extremachange",(function(t){e._config.onExtremaChange&&e._config.onExtremaChange({min:t.min,max:t.max,gradient:e._config.gradient||e._config.defaultGradient})})),r.setCoordinator(n)};function a(){var a=this._config=i(e,arguments[0]||{});if(this._coordinator=new n,a.plugin){var s=a.plugin;if(!e.plugins[s])throw new Error("Plugin '"+s+"' not found. Maybe it was not registered.");var l=e.plugins[s];this._renderer=new l.renderer(a),this._store=new l.store(a)}else this._renderer=new r(a),this._store=new t(a);o(this)}return a.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(e){return this._config=i(this._config,e),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(e){return this._store.getValueAt?this._store.getValueAt(e):this._renderer.getValueAt?this._renderer.getValueAt(e):null}},a}();return{create:function(e){return new o(e)},register:function(t,n){e.plugins[t]=n}}}))},function(e,t,n){"use strict";n.r(t);var r=window.DC.getNamespace().Cesium;function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}DC.GlobeRotate=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,o=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;i(this,e),this._viewer=t,this._time=r,this._callback=o,this._startRotate();var s=setTimeout((function(){n._endRotate(),n._callback&&n._callback.call(a||n),clearTimeout(s)}),1e3*Number(this._time))}var t,n,a;return t=e,(n=[{key:"_icrf",value:function(e,t){if(e.mode===r.SceneMode.SCENE3D){var n=r.Transforms.computeIcrfToFixedMatrix(t);if(r.defined(n)){var i=this._viewer.delegate.camera,o=r.Cartesian3.clone(i.position),a=r.Matrix4.fromRotationTranslation(n);i.lookAtTransform(a,o)}}}},{key:"_startRotate",value:function(){this._viewer.delegate.camera.lookAtTransform(r.Matrix4.IDENTITY),this._viewer.delegate.clock.multiplier=12e3,this._viewer.delegate.scene.postUpdate.addEventListener(this._icrf,this)}},{key:"_endRotate",value:function(){this._viewer.delegate.camera.lookAtTransform(r.Matrix4.IDENTITY),this._viewer.delegate.clock.multiplier=1,this._viewer.delegate.clock.currentTime=r.JulianDate.now().clone(),this._viewer.delegate.scene.postUpdate.removeEventListener(this._icrf,this)}}])&&o(t.prototype,n),a&&o(t,a),e}(),DC.AroundView=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),this._viewer=t,this._options=n,this._heading=t.camera.heading,this._startTime=r.JulianDate.fromDate(new Date),this._stopTime=r.JulianDate.addSeconds(this._startTime,this._options.duration||10,new r.JulianDate)}var t,n,i;return t=e,(n=[{key:"_start",value:function(){this._viewer.clock.startTime=this._startTime.clone(),this._viewer.clock.stopTime=this._stopTime.clone(),this._viewer.clock.currentTime=this._startTime.clone(),this._viewer.clock.onTick.addEventListener(this._onTickHandler,this)}},{key:"_onTickHandler",value:function(){var e=r.JulianDate.secondsDifference(this._viewer.clock.currentTime,this._viewer.clock.startTime),t=this._options.duration||10,n=r.Math.toRadians(e*(360/t))+this._heading;this._viewer.scene.camera.setView({orientation:{heading:n}}),r.JulianDate.compare(this._viewer.clock.currentTime,this._viewer.clock.stopTime)>=0&&(this._viewer.clock.onTick.removeEventListener(this._onTickHandler,this),this._options._callback&&this._options._callback.call(this._options.context||this))}}])&&s(t.prototype,n),i&&s(t,i),e}(),DC.AroundPoint=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(l(this,e),!(n&&n instanceof DC.Position))throw new Error("the position invalid");this._viewer=t,this._position=n,this._options=i,this._heading=t.camera.heading,this._startTime=r.JulianDate.fromDate(new Date),this._stopTime=r.JulianDate.addSeconds(this._startTime,this._options.duration||10,new r.JulianDate)}var t,n,i;return t=e,(n=[{key:"_start",value:function(){this._viewer.clock.startTime=this._startTime.clone(),this._viewer.clock.stopTime=this._stopTime.clone(),this._viewer.clock.currentTime=this._startTime.clone(),this._viewer.clock.onTick.addEventListener(this._onTickHandler,this)}},{key:"_onTickHandler",value:function(){var e=r.JulianDate.secondsDifference(this._viewer.clock.currentTime,this._viewer.clock.startTime),t=this._options.duration||10,n=r.Math.toRadians(e*(360/t))+this._heading;this._viewer.scene.camera.setView({destination:DC.T.transformWSG84ToCartesian(this._position),orientation:{heading:n,pitch:r.Math.toRadians(this._options.pitch||0)}}),this._options.distance&&this._viewer.scene.camera.moveBackward(this._options.distance),r.JulianDate.compare(this._viewer.clock.currentTime,this._viewer.clock.stopTime)>=0&&(this._viewer.clock.onTick.removeEventListener(this._onTickHandler,this),this._options._callback&&this._options._callback.call(this._options.context||this))}}])&&c(t.prototype,n),i&&c(t,i),e}();var y={resolution:1,material:new r.PolylineGlowMaterialProperty({glowPower:.1,color:r.Color.YELLOW}),width:10};function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}DC.Roaming=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t,this._positions=[],this._modelPath=n.modelPath,this._modelScale=n.modelScale||1,this._modelShow=n.modelShow||!0,this._time=n.time||360,this._startTime=void 0,this._endTime=void 0,this._showPath=n.showPath||!1,this._delegate=new r.Entity,this._perspective=n.perspective||0,this._parsePositions(n.positions)}var t,n,i;return t=e,(n=[{key:"_parsePositions",value:function(e){if("string"==typeof e){if(e.indexOf("#")>=0)throw new Error("the positions invalid");e=e.split(";")}this._positions=e.map((function(e){return Array.isArray(e)?DC.Position.fromCoordArray(e):e instanceof DC.Position?e:DC.Position.fromCoordString(e)}))}},{key:"_preparePositionProperty",value:function(){var e=this,t=new r.SampledPositionProperty;if(this._positions.length){var n=this._time-this._time%this._positions.length;this._startTime=r.JulianDate.now();var i=n/this._positions.length;this._endTime=r.JulianDate.addSeconds(this._startTime,n,new r.JulianDate),this._positions.forEach((function(n,o){var a=r.JulianDate.addSeconds(e._startTime,o*i,new r.JulianDate);t.addSample(a,DC.T.transformWSG84ToCartesian(n))}))}return t}},{key:"_prepareDelegate",value:function(){var e=this._preparePositionProperty();this._delegate.merge({position:e,orientation:new r.VelocityOrientationProperty(e),model:{uri:this._modelPath,scale:this._modelScale,show:this._modelShow},path:f({},y,{show:this._showPath})}),this._startTime&&this._endTime&&(this._delegate.availability=new r.TimeIntervalCollection([new r.TimeInterval({start:this._startTime,stop:this._endTime})])),this._delegate.position.setInterpolationOptions({interpolationDegree:5,interpolationAlgorithm:r.LagrangePolynomialApproximation})}},{key:"_setClock",value:function(){this._viewer.delegate.clock.startTime=this._startTime.clone(),this._viewer.delegate.clock.stopTime=this._endTime.clone(),this._viewer.delegate.clock.currentTime=this._startTime.clone()}},{key:"setSpeed",value:function(e){this._viewer.delegate.clock.multiplier=e}},{key:"setPerspective",value:function(e){this._perspective=e,this._delegate.model&&(0===e?this._viewer.delegate.trackedEntity=this._delegate:1===e&&(this._viewer.delegate.trackedEntity=void 0,this._viewer.delegate.zoomTo(this._delegate,new r.HeadingPitchRange(0,r.Math.toRadians(-90)))))}},{key:"reset",value:function(){this._prepareDelegate(),this._setClock(),this._viewer.delegate.clock.multiplier=1}},{key:"start",value:function(){this._viewer.delegate.entities.remove(this._delegate),this._prepareDelegate(),this._setClock(),this._viewer.delegate.entities.add(this._delegate)}},{key:"stop",value:function(){this._viewer.delegate.entities.remove(this._delegate),this._viewer.delegate.clock.multiplier=1,this._viewer.delegate.trackedEntity=void 0}}])&&h(t.prototype,n),i&&h(t,i),e}();var _=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t.viewer,this._handler=t.handler,this._plotEvent=t.plotEvent,this._layer=t.layer,this._delegate=new r.Entity}var t,n,i;return t=e,(n=[{key:"_bindEvent",value:function(){var e=this;this._handler.setInputAction((function(t){e._mouseClickHandler&&e._mouseClickHandler(t)}),r.ScreenSpaceEventType.LEFT_CLICK),this._handler.setInputAction((function(t){e._mouseMoveHandler&&e._mouseMoveHandler(t)}),r.ScreenSpaceEventType.MOUSE_MOVE),this._handler.setInputAction((function(t){e._mouseDbClickHandler&&e._mouseDbClickHandler(t)}),r.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}},{key:"_unbindEnvet",value:function(){this._handler.removeInputAction(r.ScreenSpaceEventType.LEFT_CLICK),this._handler.removeInputAction(r.ScreenSpaceEventType.MOUSE_MOVE),this._handler.removeInputAction(r.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}},{key:"_prepareDelegate",value:function(){}},{key:"start",value:function(){this._bindEvent(),this._prepareDelegate()}}])&&d(t.prototype,n),i&&d(t,i),e}();function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D={pixelSize:10,outlineColor:r.Color.BLUE,outlineWidth:5},P=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=C(this,O(t).call(this,e)))._position=r.Cartesian3.ZERO,i._style=g({},D,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){this._position=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84),this._unbindEnvet(),this._plotEvent.raiseEvent({type:DC.OverlayType.POINT,points:[DC.T.transformCartesianToWSG84(this._position)]})}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位"),this._position=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84),this._viewer.tooltip.setPosition(this._position)}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.position=new r.CallbackProperty((function(t){return e._position})),this._delegate.point=g({},this._style),this._layer.entities.add(this._delegate)}}])&&w(n.prototype,i),o&&w(n,o),t}(_);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I={width:3,material:r.Color.BLUE.withAlpha(.6)},L=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=A(this,z(t).call(this,e)))._tempLine=new r.Entity,i._positions=[],i._tempPoints=[],i._style=T({},I,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84);t&&this._positions.push(t)}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位,双击结束");var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84);this._viewer.tooltip.setPosition(t),t&&this._positions.length>0&&(this._viewer.tooltip.setPosition(t),this._tempPoints=[this._positions[this._positions.length-1],t])}},{key:"_mouseDbClickHandler",value:function(e){this._unbindEnvet(),this._positions.length>2&&(this._positions=this._positions.slice(0,-1)),this._plotEvent.raiseEvent({type:DC.OverlayType.POLYLINE,points:DC.T.transformCartesianArrayToWSG84Array(this._positions)})}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.polyline=T({positions:new r.CallbackProperty((function(t){return e._positions}))},this._style),this._tempLine.polyline=T({positions:new r.CallbackProperty((function(t){return e._tempPoints}))},this._style),this._layer.entities.add(this._delegate),this._layer.entities.add(this._tempLine)}}])&&j(n.prototype,i),o&&j(n,o),t}(_);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U={material:r.Color.BLUE.withAlpha(.6)},Z=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=N(this,q(t).call(this,e)))._hierarchy=new r.PolygonHierarchy,i._positions=[],i._tempPoints=[],i._style=V({},U,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84);t&&(2===this._positions.length&&(this._delegate.polyline.show=!1),this._positions.push(t),this._hierarchy.positions=this._positions)}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位,双击结束");var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84);this._viewer.tooltip.setPosition(t),t&&this._positions.length>0&&(this._tempPoints=[this._positions[this._positions.length-1],t],this._hierarchy.positions=[].concat(W(this._positions),[t]))}},{key:"_mouseDbClickHandler",value:function(e){this._unbindEnvet(),this._positions.length>2&&(this._positions=this._positions.slice(0,-1)),this._plotEvent.raiseEvent({type:DC.OverlayType.POLYGON,points:DC.T.transformCartesianArrayToWSG84Array(this._positions)})}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.polygon=V({hierarchy:new r.CallbackProperty((function(t){return e._hierarchy}))},this._style),this._delegate.polyline=V({positions:new r.CallbackProperty((function(t){return e._tempPoints}))},this._style),this._layer.entities.add(this._delegate)}}])&&G(n.prototype,i),o&&G(n,o),t}(_);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){X(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ne={width:3,material:r.Color.BLUE.withAlpha(.6)},re=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=$(this,ee(t).call(this,e)))._center=r.Cartesian3.ZERO,i._radius=0,i._style=J({},ne,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84);t&&this._center===r.Cartesian3.ZERO?this._center=t:(this._computeRadius(this._center,t),this._unbindEnvet(),this._plotEvent.raiseEvent({type:DC.OverlayType.CIRCLE,points:[DC.T.transformCartesianToWSG84(this._center)],radius:this._radius}))}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位");var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84);this._viewer.tooltip.setPosition(t),t&&this._center!==r.Cartesian3.ZERO&&this._computeRadius(this._center,t)}},{key:"_computeRadius",value:function(e,t){var n=r.Cartographic.fromCartesian(e),i=r.Cartographic.fromCartesian(t),o=new r.EllipsoidGeodesic;o.setEndPoints(n,i);var a=o.surfaceDistance;this._radius=Math.sqrt(Math.pow(a,2)+Math.pow(i.height-n.height,2))}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.position=new r.CallbackProperty((function(t){return e._center})),this._delegate.ellipse=J({semiMajorAxis:new r.CallbackProperty((function(t){return e._radius})),semiMinorAxis:new r.CallbackProperty((function(t){return e._radius}))},this._style),this._delegate.point={pixelSize:10,outlineColor:r.Color.RED,outlineWidth:3},this._layer.entities.add(this._delegate)}}])&&Q(n.prototype,i),o&&Q(n,o),t}(_);function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ue(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var he={material:r.Color.BLUE.withAlpha(.6)},ye=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ue(this,fe(t).call(this,e)))._coordinates=new r.Rectangle,i._positions=[],i._style=se({},he,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84);t&&(this._positions.push(t),2===this._positions.length&&(this._coordinates=r.Rectangle.fromCartesianArray(this._positions,r.Ellipsoid.WGS84),this._unbindEnvet(),this._plotEvent.raiseEvent({type:DC.OverlayType.RECT,points:DC.T.transformCartesianArrayToWSG84Array(this._positions)})))}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位");var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84);t&&(this._viewer.tooltip.setPosition(t),this._coordinates=r.Rectangle.fromCartesianArray([].concat(oe(this._positions),[t]),r.Ellipsoid.WGS84))}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.rectangle=se({coordinates:new r.CallbackProperty((function(t){return e._coordinates}))},this._style),this._layer.entities.add(this._delegate)}}])&&ce(n.prototype,i),o&&ce(n,o),t}(_);function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}DC.Plot=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t,this._plotEvent=new r.Event,this._handler=new r.ScreenSpaceEventHandler(this._viewer.canvas),this._callback=void 0,this._drawWorker=void 0,this._editWorker=void 0,this._layer=new r.CustomDataSource("dc-plot"),this._viewer.delegate&&this._viewer.delegate.dataSources.add(this._layer)}var t,n,i;return t=e,(n=[{key:"_completeCallback",value:function(e){this._drawWorker=void 0,this._viewer.tooltip.enable=!1,this._layer.entities.removeAll(),this._callback&&this._callback.call(this,e)}},{key:"_bindEvent",value:function(e){this._plotEvent.removeEventListener(this._completeCallback,this),this._callback=e,this._plotEvent.addEventListener(this._completeCallback,this)}},{key:"_createDrawWorker",value:function(e,t){var n={viewer:this._viewer,handler:this._handler,plotEvent:this._plotEvent,layer:this._layer};e===DC.OverlayType.POINT?this._drawWorker=new P(n,t):e===DC.OverlayType.POLYLINE?this._drawWorker=new L(n,t):e===DC.OverlayType.POLYGON?this._drawWorker=new Z(n,t):e===DC.OverlayType.CIRCLE?this._drawWorker=new re(n,t):e===DC.OverlayType.RECT&&(this._drawWorker=new ye(n,t))}},{key:"_createEditWorker",value:function(e){this._viewer,this._handler,this._plotEvent,this._layer}},{key:"draw",value:function(e,t,n){this._viewer.tooltip.enable=!0,this._bindEvent(t),this._createDrawWorker(e,n),this._drawWorker.start()}},{key:"edit",value:function(e,t){this._bindEvent(callback)}}])&&de(t.prototype,n),i&&de(t,i),e}();var _e=n(3),me=n(4),ve=n(5),ge=n(6),be=n(7),we=n(8),Ce=n(0),Oe=n(0),xe=n(9),De=n(10),Pe=n(11),Ee=n(12),ke=n(13),Te=n(14),Se=n(15),je=n(16),Ae=n(17),ze=n(18),Me=n(19);function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r.ShaderSource._czmBuiltinsAndUniforms.czm_cellular=ge,r.ShaderSource._czmBuiltinsAndUniforms.czm_snoise=be,r.Material.PolylineEmissionType="PolylineEmission",r.Material._materialCache.addMaterial(r.Material.PolylineEmissionType,{fabric:{type:r.Material.PolylineEmissionType,uniforms:{color:new r.Color(1,0,0,.7)},source:_e},translucent:function(e){return!0}}),r.Material.PolylineFlowType="PolylineFlow",r.Material._materialCache.addMaterial(r.Material.PolylineFlowType,{fabric:{type:r.Material.PolylineFlowType,uniforms:{color:new r.Color(1,0,0,.7),duration:45},source:me},translucent:function(e){return!0}}),r.Material.PolylineTrailType="PolylineTrail",r.Material._materialCache.addMaterial(r.Material.PolylineTrailType,{fabric:{type:r.Material.PolylineTrailType,uniforms:{color:new r.Color(1,0,0,.7),image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAAgCAYAAABkS8DlAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAADSSURBVHja7NYxEoUgDEDBYM39z2qHtZViwMFxt1FJnF/98ZXWWkRE7LWWOOt5Lsm9q/vsbu9Zdtazs/J19O5bs1XPZrwze/6V31zxbOZs1n905Wt2p3f25GzE7ohv6q3nLQCA3xEAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAA8g4AAAD//wMA4WEFTJOT5UIAAAAASUVORK5CYII=",duration:45},source:ve},translucent:function(e){return!0}}),r.Material.AsphaltType="Asphalt",r.Material._materialCache.addMaterial(r.Material.AsphaltType,{fabric:{type:r.Material.AsphaltType,uniforms:{asphaltColor:new r.Color(.15,.15,.15,1),bumpSize:.02,roughness:.2},source:we},translucent:function(e){return e.uniforms.asphaltColor.alpha<1}}),r.Material.BlobType="Blob",r.Material._materialCache.addMaterial(r.Material.BlobType,{fabric:{type:r.Material.BlobType,uniforms:{lightColor:new r.Color(1,1,1,.5),darkColor:new r.Color(0,0,1,.5),frequency:10},source:Ce},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}}),r.Material.BrickType="Brick",r.Material._materialCache.addMaterial(r.Material.BrickType,{fabric:{type:r.Material.BrickType,uniforms:{brickColor:new r.Color(.6,.3,.1,1),mortarColor:new r.Color(.8,.8,.7,1),brickSize:new r.Cartesian2(.3,.15),brickPct:new r.Cartesian2(.9,.85),brickRoughness:.2,mortarRoughness:.1},source:Oe},translucent:function(e){var t=e.uniforms;return t.brickColor.alpha<1||t.mortarColor.alpha<1}}),r.Material.CementType="Cement",r.Material._materialCache.addMaterial(r.Material.CementType,{fabric:{type:r.Material.CementType,uniforms:{cementColor:new r.Color(.95,.95,.85,1),grainScale:.01,roughness:.3},source:xe},translucent:function(e){return e.uniforms.cementColor.alpha<1}}),r.Material.ErosionType="Erosion",r.Material._materialCache.addMaterial(r.Material.ErosionType,{fabric:{type:r.Material.ErosionType,uniforms:{color:new r.Color(1,0,0,.5),time:1},source:De},translucent:function(e){return e.uniforms.color.alpha<1}}),r.Material.FacetType="Facet",r.Material._materialCache.addMaterial(r.Material.FacetType,{fabric:{type:r.Material.FacetType,uniforms:{lightColor:new r.Color(.25,.25,.25,.75),darkColor:new r.Color(.75,.75,.75,.75),frequency:10},source:Pe},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}}),r.Material.FresnelType="Fresnel",r.Material._materialCache.addMaterial(r.Material.FresnelType,{fabric:{type:r.Material.FresnelType,materials:{reflection:{type:r.Material.ReflectionType},refraction:{type:r.Material.RefractionType}},source:Ee},translucent:!1}),r.Material.GrassType="Grass",r.Material._materialCache.addMaterial(r.Material.GrassType,{fabric:{type:r.Material.GrassType,uniforms:{grassColor:new r.Color(.25,.4,.1,1),dirtColor:new r.Color(.1,.1,.1,1),patchiness:1.5},source:ke},translucent:function(e){var t=e.uniforms;return t.grassColor.alpha<1||t.dirtColor.alpha<1}}),r.Material.ReflectionType="Reflection",r.Material._materialCache.addMaterial(r.Material.ReflectionType,{fabric:{type:r.Material.ReflectionType,uniforms:{cubeMap:r.Material.DefaultCubeMapId,channels:"rgb"},source:Te},translucent:!1}),r.Material.RefractionType="Refraction",r.Material._materialCache.addMaterial(r.Material.RefractionType,{fabric:{type:r.Material.RefractionType,uniforms:{cubeMap:r.Material.DefaultCubeMapId,channels:"rgb",indexOfRefractionRatio:.9},source:Se},translucent:!1}),r.Material.TyeDyeType="TieDye",r.Material._materialCache.addMaterial(r.Material.TyeDyeType,{fabric:{type:r.Material.TyeDyeType,uniforms:{lightColor:new r.Color(1,1,0,.75),darkColor:new r.Color(1,0,0,.75),frequency:5},source:je},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}}),r.Material.WoodType="Wood",r.Material._materialCache.addMaterial(r.Material.WoodType,{fabric:{type:r.Material.WoodType,uniforms:{lightWoodColor:new r.Color(.6,.3,.1,1),darkWoodColor:new r.Color(.4,.2,.07,1),ringFrequency:3,noiseScale:new r.Cartesian2(.7,.5),grainFrequency:27},source:Ae},translucent:function(e){var t=e.uniforms;return t.lightWoodColor.alpha<1||t.darkWoodColor.alpha<1}}),r.Material.CircleFadeType="CircleFade",r.Material._materialCache.addMaterial(r.Material.CircleFadeType,{fabric:{type:r.Material.CircleFadeType,uniforms:{color:new r.Color(1,0,0,.7),duration:45},source:ze},translucent:function(e){return!0}}),r.Material.CircleWaveType="CircleWave",r.Material._materialCache.addMaterial(r.Material.CircleWaveType,{fabric:{type:r.Material.CircleWaveType,uniforms:{color:new r.Color(1,0,0,.7),duration:45},source:Me},translucent:function(e){return!0}}),DC.PolylineTrailMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this._duration=void 0,this._durationSubscription=void 0,this.color=r.defaultValue(t.color,r.Color.fromBytes(0,255,255,255)),this.duration=r.defaultValue(t.duration,45)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.PolylineTrailType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrClonedDefault(this._color,e,r.Color.WHITE,t.color),t.duration=this._duration,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.PolylineTrailMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&Ie(t.prototype,n),i&&Ie(t,i),e}(),Object.defineProperties(DC.PolylineTrailMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),duration:r.createPropertyDescriptor("duration")}),DC.PolylineFlowMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this.color=r.defaultValue(t.color,r.Color.fromBytes(0,255,255,255)),this._duration=void 0,this._durationSubscription=void 0,this.duration=r.defaultValue(t.duration,45)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.PolylineFlowType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrClonedDefault(this._color,e,r.Color.WHITE,t.color),t.duration=this._duration,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.PolylineFlowMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&Le(t.prototype,n),i&&Le(t,i),e}(),Object.defineProperties(DC.PolylineFlowMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),duration:r.createPropertyDescriptor("duration")}),DC.PolylineEmissionMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this.color=r.defaultValue(t.color,new r.Color(1,0,0,.7))}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.PolylineEmissionType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrUndefined(this._color,e),t}},{key:"equals",value:function(e){return this===e||e instanceof DC.PolylineEmissionMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&Re(t.prototype,n),i&&Re(t,i),e}(),Object.defineProperties(DC.PolylineEmissionMaterialProperty.prototype,{color:r.createPropertyDescriptor("color")}),DC.WaterMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._baseWaterColor=void 0,this._baseWaterColorSubscription=void 0,this.baseWaterColor=r.defaultValue(t.baseWaterColor,new r.Color(.2,.3,.6,1)),this._blendColor=void 0,this._blendColorSubscription=void 0,this.blendColor=r.defaultValue(t.blendColor,new r.Color(0,1,.699,1)),this._specularMap=void 0,this._specularMapSubscription=void 0,this.specularMap=r.defaultValue(t.specularMap,r.Material.DefaultImageId),this._normalMap=void 0,this._normalMapSubscription=void 0,this.normalMap=r.defaultValue(t.normalMap,r.Material.DefaultImageId),this.frequency=r.defaultValue(t.frequency,10),this.animationSpeed=r.defaultValue(t.animationSpeed,.01),this.amplitude=r.defaultValue(t.amplitude,1),this.specularIntensity=r.defaultValue(t.specularIntensity,.5),this.fadeFactor=r.defaultValue(t.fadeFactor,1)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.WaterType}},{key:"getValue",value:function(e,t){return t||(t={}),t.baseWaterColor=r.Property.getValueOrUndefined(this._baseWaterColor,e),t.blendColor=r.Property.getValueOrUndefined(this._blendColor,e),t.specularMap=r.Property.getValueOrUndefined(this._specularMap,e),t.normalMap=r.Property.getValueOrUndefined(this._normalMap,e),t.frequency=this.frequency,t.animationSpeed=this.animationSpeed,t.amplitude=this.amplitude,t.specularIntensity=this.specularIntensity,t.fadeFactor=this.fadeFactor,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.WaterMaterialProperty&&r.Property.equals(this._baseWaterColor,e._baseWaterColor)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&We(t.prototype,n),i&&We(t,i),e}(),Object.defineProperties(DC.WaterMaterialProperty.prototype,{baseWaterColor:r.createPropertyDescriptor("baseWaterColor"),blendColor:r.createPropertyDescriptor("blendColor"),specularMap:r.createPropertyDescriptor("specularMap"),normalMap:r.createPropertyDescriptor("normalMap")}),DC.RimLightingMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this.color=r.defaultValue(t.color,new r.Color(1,0,0,.7)),this._rimColor=void 0,this._rimColorSubscription=void 0,this.rimColor=r.defaultValue(t.rimColor,new r.Color(1,1,1,.4)),this._width=void 0,this._widthSubscription=void 0,this.width=r.defaultValue(t.width,.3)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.RimLightingType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrUndefined(this._color,e),t.rimColor=r.Property.getValueOrUndefined(this._rimColor,e),t.width=r.Property.getValueOrUndefined(this._width,e),t}},{key:"equals",value:function(e){return this===e||e instanceof DC.RimLightingMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&Fe(t.prototype,n),i&&Fe(t,i),e}(),Object.defineProperties(DC.RimLightingMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),rimColor:r.createPropertyDescriptor("rimColor"),width:r.createPropertyDescriptor("width")}),DC.CircleFadeMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this._duration=void 0,this._durationSubscription=void 0,this.color=r.defaultValue(t.color,r.Color.fromBytes(0,255,255,255)),this.duration=r.defaultValue(t.duration,45)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.CircleFadeType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrUndefined(this._color,e),t.duration=this._duration,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.CircleFadeMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&Ve(t.prototype,n),i&&Ve(t,i),e}(),Object.defineProperties(DC.CircleFadeMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),duration:r.createPropertyDescriptor("duration")}),DC.CircleWaveMaterialProperty=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._definitionChanged=new r.Event,this._color=void 0,this._colorSubscription=void 0,this._duration=void 0,this._durationSubscription=void 0,this.color=r.defaultValue(t.color,r.Color.fromBytes(0,255,255,255)),this.duration=r.defaultValue(t.duration,45),this.count=Math.max(r.defaultValue(t.count,2),1),this.gradient=r.defaultValue(t.gradient,.1),this.gradient<0?this.gradient=0:this.gradient>1&&(this.gradient=1)}var t,n,i;return t=e,(n=[{key:"getType",value:function(e){return r.Material.CircleWaveType}},{key:"getValue",value:function(e,t){return t||(t={}),t.color=r.Property.getValueOrUndefined(this._color,e),t.duration=this._duration,t.count=this.count,t.gradient=this.gradient,t}},{key:"equals",value:function(e){return this===e||e instanceof DC.CircleWaveMaterialProperty&&r.Property.equals(this._color,e._color)}},{key:"isConstant",get:function(){return!1}},{key:"definitionChanged",get:function(){return this._definitionChanged}}])&&Be(t.prototype,n),i&&Be(t,i),e}(),Object.defineProperties(DC.CircleWaveMaterialProperty.prototype,{color:r.createPropertyDescriptor("color"),duration:r.createPropertyDescriptor("duration")});var Ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventCache={}}var t,n,r;return t=e,(n=[{key:"_registerEvent",value:function(){}},{key:"_on",value:function(e,t,n){var r=this.getEvent(e);t&&r&&r.addEventListener(t,n||this)}},{key:"_off",value:function(e,t,n){var r=this.getEvent(e);r&&t&&r.removeEventListener(t,n||this)}},{key:"_fire",value:function(e,t){var n=this.getEvent(e);n&&n.raiseEvent(t)}},{key:"on",value:function(e,t,n){return this._on(e,t,n),this}},{key:"off",value:function(e,t,n){return this._off(e,t,n),this}},{key:"fire",value:function(e,t){return this._fire(e,t),this}},{key:"getEvent",value:function(e){return this._eventCache[e]||void 0}}])&&Ge(t.prototype,n),r&&Ge(t,r),e}();function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ue(e,t){return!t||"object"!==qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e,t){return(Ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ye=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ue(this,Ze(t).call(this)))._registerEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}(t,e),n=t,(i=[{key:"_registerEvent",value:function(){for(var e in DC.EffectEventType){var t=DC.EffectEventType[e];this._eventCache[t]=new r.Event}}}])&&He(n.prototype,i),o&&He(n,o),t}(Ne);function Je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t||DC.Util.uuid(),this._viewer=void 0,this._delegate=void 0,this._state=void 0,this._effectEvent=new Ye,this.type=void 0,this.on(DC.EffectEventType.ADD,this._addCallback,this),this.on(DC.EffectEventType.REMOVE,this._removeCallback,this)}var t,n,r;return t=e,(n=[{key:"_prepareDelegate",value:function(){}},{key:"_addCallback",value:function(e){this._viewer=e,this._prepareDelegate(),this._delegate&&this._viewer.delegate.scene.postProcessStages.add(this._delegate),this._state=DC.EffectState.ADDED}},{key:"_removeCallback",value:function(){this._viewer,this._delegate&&(this._viewer.delegate.scene.postProcessStages.remove(this._delegate),this._delegate=void 0),this._state=DC.EffectState.REMOVED}},{key:"addToViewer",value:function(e){return e.addEffect(this),this}},{key:"on",value:function(e,t,n){return this._effectEvent.on(e,t,n||this),this}},{key:"off",value:function(e,t,n){return this._effectEvent.off(e,t,n||this),this}},{key:"fire",value:function(e,t){return this._effectEvent.fire(e,t),this}},{key:"id",get:function(){return this._id}},{key:"effectEvent",get:function(){return this._effectEvent}}])&&Je(t.prototype,n),r&&Je(t,r),e}();function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function et(e,t){return!t||"object"!==Qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e,t){return!t||"object"!==rt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.BloomEffect=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=et(this,tt(t).call(this,e)))._contrast=128,n._brightness=-.3,n._glowOnly=!1,n._delta=1,n._sigma=2,n._stepSize=1,n._state=DC.EffectState.INITIALIZED,n.type=DC.EffectType.BLOOM,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(t,e),n=t,(r=[{key:"_prepareDelegate",value:function(){this._delegate=this._viewer.delegate.scene.postProcessStages.bloom,this._delegate.uniforms.contrast=this._contrast,this._delegate.uniforms.brightness=this._brightness,this._delegate.uniforms.glowOnly=this._glowOnly,this._delegate.uniforms.delta=this._delta,this._delegate.uniforms.sigma=this._sigma,this._delegate.uniforms.stepSize=this._stepSize}},{key:"_addCallback",value:function(e){this._viewer=e,this._prepareDelegate(),this._delegate&&(this._delegate.enabled=!0),this._state=DC.EffectState.ADDED}},{key:"_removeCallback",value:function(){this._delegate&&(this._delegate.enabled=!1,this.delegate=void 0),this._state=DC.EffectState.REMOVED}},{key:"contrast",set:function(e){this._contrast=e,this._delegate&&(this._delegate.uniforms.contrast=this._contrast)}},{key:"brightness",set:function(e){this._brightness=e,this._delegate&&(this._delegate.uniforms.brightness=this._brightness)}},{key:"glowOnly",set:function(e){this._glowOnly=e,this._delegate&&(this._delegate.uniforms.glowOnly=this._glowOnly)}},{key:"delta",set:function(e){this._delta=e,this._delegate&&(this._delegate.uniforms.delta=this._delta)}},{key:"sigma",set:function(e){this._sigma=e,this._delegate&&(this._delegate.uniforms.sigma=this._sigma)}},{key:"stepSize",set:function(e){this._stepSize=e,this._delegate&&(this._delegate.uniforms.stepSize=this._stepSize)}}])&&$e(n.prototype,r),i&&$e(n,i),t}(Xe),DC.EffectType.BLOOM="bloom";var lt=n(20);function ct(e){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ft(e,t){return!t||"object"!==ct(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ht(e,t){return(ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.CircleScanEffect=function(e){function t(e,n,i,o,a){var s;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!(n&&n instanceof DC.Position))throw new Error("the position invalid");return(s=ot(this,at(t).call(this,e)))._position=n,s._radius=i||0,s._color=r.defaultValue(o,r.Color.RED),s._duration=1e3*r.defaultValue(a,1),s._state=DC.EffectState.INITIALIZED,s.type=DC.EffectType.CIRCLE_SCAN,s}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(t,e),n=t,(i=[{key:"_prepareDelegate",value:function(){var e=this,t=DC.T.transformWSG84ToCartesian(this._position),n=new r.Cartesian4(t.x,t.y,t.z,1),i=DC.T.transformWSG84ToCartesian(new DC.Position(this._position.lng,this._position.lat,this._position.alt+500)),o=new r.Cartesian4(i.x,i.y,i.z,1),a=(new Date).getTime();this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:lt,uniforms:{u_scanCenterEC:function(){return r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,new r.Cartesian4)},u_scanPlaneNormalEC:function(){var t=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,new r.Cartesian4),i=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,o,new r.Cartesian4),a=new r.Cartesian3;return a.x=i.x-t.x,a.y=i.y-t.y,a.z=i.z-t.z,r.Cartesian3.normalize(a,a),a},u_radius:function(){return e._radius*(((new Date).getTime()-a)%e._duration)/e._duration},u_scanColor:this._color}})}}])&&it(n.prototype,i),o&&it(n,o),t}(Xe),DC.EffectType.CIRCLE_SCAN="circleScan";var yt=n(21);function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vt(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gt(e){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.RadarScanEffect=function(e){function t(e,n,i,o,a){var s;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!(n&&n instanceof DC.Position))throw new Error("the position invalid");return(s=ft(this,pt(t).call(this,e)))._position=n,s._radius=i||0,s._color=r.defaultValue(o,r.Color.RED),s._duration=1e3*r.defaultValue(a,1),s._state=DC.EffectState.INITIALIZED,s.type=DC.EffectType.RADAR_SCAN,s}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ht(e,t)}(t,e),n=t,(i=[{key:"_prepareDelegate",value:function(){var e=this,t=DC.T.transformWSG84ToCartesian(this._position),n=new r.Cartesian4(t.x,t.y,t.z,1),i=DC.T.transformWSG84ToCartesian(new DC.Position(this._position.lng,this._position.lat,this._position.alt+500)),o=new r.Cartesian4(i.x,i.y,i.z,1),a=DC.T.transformWSG84ToCartesian(new DC.Position(this._position.lng+.001,this._position.lat,this._position.alt)),s=new r.Cartesian4(a.x,a.y,a.z,1),l=(new Date).getTime(),c=new r.Quaternion,u=new r.Matrix3,f=new r.Cartesian4,p=new r.Cartesian4,h=new r.Cartesian4,y=new r.Cartesian3,d=new r.Cartesian3;this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:yt,uniforms:{u_scanCenterEC:function(){return r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,f)},u_scanPlaneNormalEC:function(){var t=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,f),i=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,o,p);return y.x=i.x-t.x,y.y=i.y-t.y,y.z=i.z-t.z,r.Cartesian3.normalize(y,y),y},u_scanLineNormalEC:function(){var t=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,n,f),i=r.Matrix4.multiplyByVector(e._viewer.delegate.camera._viewMatrix,o,p),a=r.Matrix4.multiplyByVector(viewer.camera._viewMatrix,s,h);y.x=i.x-t.x,y.y=i.y-t.y,y.z=i.z-t.z,r.Cartesian3.normalize(y,y),d.x=a.x-t.x,d.y=a.y-t.y,d.z=a.z-t.z;var _=((new Date).getTime()-l)%e._duration/e._duration;return r.Quaternion.fromAxisAngle(y,_*r.Math.PI*2,c),r.Matrix3.fromQuaternion(c,u),r.Matrix3.multiplyByVector(u,d,d),r.Cartesian3.normalize(d,d),d},u_radius:this._radius,u_scanColor:this._color}})}}])&&ut(n.prototype,i),o&&ut(n,o),t}(Xe),DC.EffectType.RADAR_SCAN="radarScan";var wt=n(22);function Ct(e){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xt(e,t){return!t||"object"!==Ct(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dt(e){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.FogEffect=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return _t(this,t),(i=vt(this,gt(t).call(this,e)))._trength=o||1,i._color=n||new r.Color(.8,.8,.8,.5),i._state=DC.EffectState.INITIALIZED,i.type=DC.EffectType.FOG,i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(t,e),n=t,(i=[{key:"_prepareDelegate",value:function(){var e=this;this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:wt,uniforms:{trength:function(){return e._trength},fogcolor:function(){return e._color}}})}}])&&mt(n.prototype,i),o&&mt(n,o),t}(Xe),DC.EffectType.FOG="fog";var Et=n(23);function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function St(e,t){return!t||"object"!==kt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function At(e,t){return(At=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.SnowEffect=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=xt(this,Dt(t).call(this,e)))._state=DC.EffectState.INITIALIZED,n.type=DC.EffectType.SNOW,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(t,e),n=t,(i=[{key:"_prepareDelegate",value:function(){this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:Et})}}])&&Ot(n.prototype,i),o&&Ot(n,o),t}(Xe),DC.EffectType.SNOW="snow";var zt=n(24);DC.RainEffect=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=St(this,jt(t).call(this,e)))._state=DC.EffectState.INITIALIZED,n.type=DC.EffectType.RAIN,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&At(e,t)}(t,e),n=t,(i=[{key:"_prepareDelegate",value:function(){this._delegate=new r.PostProcessStage({name:this._id,fragmentShader:zt})}}])&&Tt(n.prototype,i),o&&Tt(n,o),t}(Xe),DC.EffectType.RAIN="rain";function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lt(e,t){return!t||"object"!==Mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wt(e,t){return(Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ft=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Lt(this,Rt(t).call(this)))._registerEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wt(e,t)}(t,e),n=t,(i=[{key:"_registerEvent",value:function(){for(var e in DC.LayerEventType){var t=DC.LayerEventType[e];this._eventCache[t]=new r.Event}}}])&&It(n.prototype,i),o&&It(n,o),t}(Ne);function Vt(e){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gt(e,t){return!t||"object"!==Vt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ht=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Gt(this,Nt(t).call(this)))._registerEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qt(e,t)}(t,e),n=t,(i=[{key:"_registerEvent",value:function(){for(var e in DC.MouseEventType){var t=DC.MouseEventType[e];this._eventCache[t]=new r.Event}for(var n in DC.OverlayEventType){var i=DC.OverlayEventType[n];this._eventCache[i]=new r.Event}}}])&&Bt(n.prototype,i),o&&Bt(n,o),t}(Ne);function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t||DC.Util.uuid(),this._delegate=void 0,this._viewer=void 0,this._state=void 0,this._show=!0,this._cache={},this._attr={},this._style={},this._layerEvent=new Ft,this._layerEvent.on(DC.LayerEventType.ADD,this._addCallback,this),this._layerEvent.on(DC.LayerEventType.REMOVE,this._removeCallback,this),this._layerEvent.on(DC.LayerEventType.ADD_OVERLAY,this._addOverlayCallback,this),this._layerEvent.on(DC.LayerEventType.REMOVE_OVERLAY,this._removeOverlayCallback,this),this.type=void 0}var t,n,i;return t=e,(n=[{key:"_addCallback",value:function(e){this._viewer=e,this._delegate&&(this._delegate instanceof r.PrimitiveCollection?this._viewer.delegate.scene.primitives.add(this._delegate):this._viewer.delegate.dataSources.add(this._delegate),this._state=DC.LayerState.ADDED)}},{key:"_removeCallback",value:function(){this._delegate&&this._viewer&&(this._cache={},this._delegate instanceof r.PrimitiveCollection?(this._delegate.removeAll(),this._viewer.delegate.scene.primitives.remove(this._delegate)):this._delegate.then?(this._delegate.then((function(e){e.entities.removeAll()})),this._viewer.delegate.dataSources.remove(this._delegate)):(this._delegate.entities&&this._delegate.entities.removeAll(),this._viewer.delegate.dataSources.remove(this._delegate)),this._state=DC.LayerState.REMOVED)}},{key:"_addOverlayCallback",value:function(e){e&&e.overlayEvent&&e.state!==DC.OverlayState.ADDED&&(e.overlayEvent.fire(DC.OverlayEventType.ADD,this),this._cache[e.id]=e)}},{key:"_removeOverlayCallback",value:function(e){e&&e.overlayEvent&&e.state!==DC.OverlayState.REMOVED&&(e.overlayEvent.fire(DC.OverlayEventType.REMOVE,this),delete this._cache[e.id])}},{key:"addOverlay",value:function(e){return this._addOverlayCallback(e),this}},{key:"removeOverlay",value:function(e){return this._removeOverlayCallback(e),this}},{key:"getOverlay",value:function(e){return this._cache[e]||void 0}},{key:"getOverlayByAttr",value:function(e,t){var n=void 0;for(var r in this._cache)this._cache[r].attr[e]===t&&(n=this._cache[r]);return n}},{key:"eachOverlay",value:function(e,t){for(var n in this._cache)e.call(t,this._cache[n]);return this}},{key:"clear",value:function(){}},{key:"remove",value:function(){this._viewer&&this._viewer.removeLayer(this)}},{key:"addToViewer",value:function(e){return e&&e.addLayer&&e.addLayer(this),this}},{key:"setStyle",value:function(e){}},{key:"show",set:function(e){this._show=e,this._delegate&&(this._delegate.show=this._show)},get:function(){return this._show}},{key:"layerEvent",get:function(){return this._layerEvent}},{key:"attr",set:function(e){this._attr=e},get:function(){return this._attr}},{key:"id",get:function(){return this._id}},{key:"delegate",get:function(){return this._delegate}},{key:"state",get:function(){return this._state}}])&&Ut(t.prototype,n),i&&Ut(t,i),e}();function Kt(e){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xt(e,t){return!t||"object"!==Kt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qt(e){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $t(e,t){return($t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function en(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tn=n(25),nn=new r.WebMercatorProjection,rn={maxOpacity:.8,minOpacity:.1,blur:.85,xField:"lng",yField:"lat",gradient:en({.5:"blue",.8:"red",.95:"white",.6:"yellow"},"0.5","green")};function on(e){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function an(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ln(e,t){return!t||"object"!==on(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cn(e){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function un(e,t){return(un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yn(e,t){return!t||"object"!==fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _n(e,t){return(_n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gn(e,t){return!t||"object"!==mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cn(e){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function On(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dn(e,t){return!t||"object"!==Cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pn(e){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.HeatmapLayer=function(e){function t(e,n,i){var o;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!n||2!==n.length)throw new Error("the bounds is empty");return(o=Xt(this,Qt(t).call(this,e)))._options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){en(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},rn,{},i),o._delegate=new r.CustomDataSource(e),o._data=[],o._width=0,o._height=0,o._scale=1,o._mBounds=o._computeMercatorBounds(n),o._oriX=o._mBounds.west,o._oriY=o._mBounds.south,o._computeWidthAndHeight(),o._options.radius=Math.round(o._options.radius?o._options.radius:Math.max(o._width,o._height)/60),o._spacing=1.5*o._options.radius,o._heatmapInstance=void 0,o._entity=new r.Entity,o._prepareHeatmap(),o._state=DC.LayerState.INITIALIZED,o.type=DC.LayerType.HEAT,o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}(t,e),n=t,(i=[{key:"_transformWgs84ToMercator",value:function(e){var t=nn.project(r.Cartographic.fromDegrees(e.lng,e.lat));return{lng:t.x,lat:t.y}}},{key:"_transformMercatorToWgs84",value:function(e){var t=nn.unproject(new r.Cartesian3(e.lng,e.lat));return{lng:r.Math.toDegrees(t.longitude),lat:r.Math.toDegrees(t.latitude)}}},{key:"_transformWgs84ToHeatmap",value:function(e){e=this._transformWgs84ToMercator(e);var t={};return t.lng=Math.round((e.lng-this._oriX)/this._scale+this._spacing),t.lat=Math.round((e.lat-this._oriY)/this._scale+this._spacing),t.lat=this._height-t.lat,t}},{key:"_computeMercatorBounds",value:function(e){var t=this._transformWgs84ToMercator(e[0]),n=this._transformWgs84ToMercator(e[1]);return{west:t.lng,south:t.lat,east:n.lng,north:n.lat}}},{key:"_computeWidthAndHeight",value:function(){this._width=this._mBounds.east>0&&this._mBounds.west<0?this._mBounds.east+Math.abs(this._mBounds.west):Math.abs(this._mBounds.east-this._mBounds.west),this._height=this._mBounds.north>0&&this._mBounds.south<0?this._mBounds.north+Math.abs(this._mBounds.south):Math.abs(this._mBounds.north-this._mBounds.south);var e=Math.max(this._width,this._height),t=Math.min(this._width,this._height);e>2e3?(this._scale=e/2e3,t/this._scale<700&&(this._scale=t/700)):t<700&&(this._scale=t/700,e>2e3&&(this._scale=e/2e3)),this._width=this._width/this._scale,this._height=this._height/this._scale}},{key:"_prepareHeatmap",value:function(){var e=Math.round(this._width+2*this._spacing),t=Math.round(this._height+2*this._spacing),n=DC.DomUtil.create("div","heat-map",document.getElementsByClassName("dc-container")[0]);n.style.cssText="\n    width:".concat(e,"px;\n    height:").concat(t,"px;\n    margin:0;\n    display:none"),this._options.container=n,this._heatmapInstance=tn.create(this._options);var i=this._spacing*this._scale,o=this._transformMercatorToWgs84({lng:this._mBounds.west-i,lat:this._mBounds.south-i}),a=this._transformMercatorToWgs84({lng:this._mBounds.east+i,lat:this._mBounds.north+i}),s=r.Rectangle.fromDegrees(o.lng,o.lat,a.lng,a.lat);this._entity.show=!1,this._entity.rectangle={coordinates:s,fill:!1,distanceDisplayCondition:this._options.distanceDisplayCondition},this._delegate.entities.add(this._entity)}},{key:"_parseData",value:function(){var e=this,t=[];if(!this._data||!this._data.length)return{min:0,max:0,data:t};var n=this._data[0]&&this._data[0].value?this._data[0].value:0,r=this._data[0]&&this._data[0].value?this._data[0].value:1;return this._data.forEach((function(i){n=Math.min(n,i.value),r=Math.max(r,i.value);var o=e._transformWgs84ToHeatmap({lng:i.lng||i.x,lat:i.lat||i.y});t.push({lng:o.lng,lat:o.lat,value:i.value||0})})),{min:n,max:r,data:t}}},{key:"_reDraw",value:function(){this._heatmapInstance.setData(this._parseData())}},{key:"setPositions",value:function(e){if(!e||!Array.isArray(e))return this;if(this._data=e,this._reDraw(),this._entity&&this._entity.rectangle){var t=new r.ImageMaterialProperty({image:this._heatmapInstance._renderer.canvas,transparent:!0});this._entity.show=!0,DC.Util.merge(this._entity.rectangle,{fill:!0,material:t})}}}])&&Jt(n.prototype,i),o&&Jt(n,o),t}(Zt),DC.LayerType.HEAT="heat",DC.CzmlLayer=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(an(this,t),!n)throw new Error("the url is empty");return(i=ln(this,cn(t).call(this,e)))._delegate=r.CzmlDataSource.load(n,o),i._state=DC.LayerState.INITIALIZED,i.type=DC.LayerType.CZML,i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&un(e,t)}(t,e),n=t,(i=[{key:"eachOverlay",value:function(e,t){if(this._delegate)return this._delegate.then((function(n){n.entities.values.forEach((function(n){e.call(t,n)}))})),this}},{key:"show",set:function(e){var t=this;this._show=e,this._delegate&&this._delegate.then((function(e){e.show=t._show}))},get:function(){return this._show}}])&&sn(n.prototype,i),o&&sn(n,o),t}(Zt),DC.LayerType.CZML="czml",DC.KmlLayer=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(pn(this,t),!n)throw new Error("the url is empty");return(i=yn(this,dn(t).call(this,e)))._delegate=r.KmlDataSource.load(n,o),i._state=DC.LayerState.INITIALIZED,i.type=DC.LayerType.KML,i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_n(e,t)}(t,e),n=t,(i=[{key:"eachOverlay",value:function(e,t){if(this._delegate)return this._delegate.then((function(n){n.entities.values.forEach((function(n){e.call(t,n)}))})),this}},{key:"show",set:function(e){var t=this;this._show=e,this._delegate&&this._delegate.then((function(e){e.show=t._show}))},get:function(){return this._show}}])&&hn(n.prototype,i),o&&hn(n,o),t}(Zt),DC.LayerType.KML="kml",DC.HtmlLayer=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=gn(this,bn(t).call(this,e)))._delegate=DC.DomUtil.create("div","html-layer"),n._delegate.setAttribute("id",n._id),n._state=DC.LayerState.INITIALIZED,n.type=DC.LayerType.HTML,n._renderCallback=void 0,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}(t,e),n=t,(i=[{key:"_addCallback",value:function(e){var t=this;this._viewer=e,this._viewer.dcContainer.appendChild(this._delegate);var n=this._viewer.scene;this._renderCallback=n.postRender.addEventListener((function(){t.eachOverlay((function(e){if(e&&e.position){var t=r.SceneTransforms.wgs84ToWindowCoordinates(n,DC.T.transformWSG84ToCartesian(e.position));t&&e._updateWindowCoord(t)}}))}),this),this._state=DC.LayerState.ADDED}},{key:"_removeCallback",value:function(){this._renderCallback(),this._viewer.dcContainer.removeChild(this._delegate),this._state=DC.LayerState.REMOVED}},{key:"clear",value:function(){this._cache={};for(var e=this._delegate.childNodes,t=e.length-1;t>=0;t--)this._delegate.removeChild(e[t]);return this._state=DC.LayerState.CLEARED,this}},{key:"show",set:function(e){this._show=e,this._delegate.style.visibility=this._show?"visible":"hidden"},get:function(){return this._show}}])&&vn(n.prototype,i),o&&vn(n,o),t}(Zt),DC.LayerType.HTML="html";var kn=DC.getNamespace().mapv;function Tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}DC.MapvDataSet=kn?kn.DataSet:void 0,DC.MapvLayer=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(On(this,t),!kn)throw new Error("miss mapv lib");return(n=Dn(this,Pn(t).call(this,e)))._option=r,n._dataSet=void 0,n._delegate=void 0,n.type=DC.LayerType.MAPV,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(t,e),n=t,(r=[{key:"_addCallback",value:function(e){this._viewer=e,this._delegate=new kn.cesiumMapLayer(this._viewer.delegate,this._dataSet||new DC.MapvDataSet([]),this._option),e.delegate.scene.canvas.setAttribute("tabIndex",0),this._state=DC.LayerState.ADDED}},{key:"_removeCallback",value:function(){this._delegate&&this._delegate.remove(),this._state=DC.LayerState.REMOVED}},{key:"setDataSet",value:function(e){this._dataSet=e,this._delegate&&this._delegate.update({data:this._dataSet,option:this._option})}},{key:"show",set:function(e){this._show=e,this._delegate&&(this._show?this._delegate.show():this._delegate.hide())},get:function(){return this._show}}])&&xn(n.prototype,r),i&&xn(n,i),t}(Zt),DC.LayerType.MAPV="mapv";var Sn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=DC.Util.uuid(),this._layer=void 0,this._state=void 0,this._delegate=void 0,this._show=!0,this._style={},this._attr={},this._overlayEvent=new Ht,this.type=void 0,this.on(DC.OverlayEventType.ADD,this._addCallback,this),this.on(DC.OverlayEventType.REMOVE,this._removeCallback,this)}var t,n,r;return t=e,(n=[{key:"_prepareDelegate",value:function(){}},{key:"_addCallback",value:function(e){this._layer=e,this._prepareDelegate(),this._layer&&this._layer.delegate&&this._layer.delegate.entities&&(this._layer.delegate.entities.add(this._delegate),this._state=DC.OverlayState.ADDED)}},{key:"_removeCallback",value:function(){this._layer&&this._layer.delegate&&this._layer.delegate.entities&&(this._layer.delegate.entities.remove(this._delegate),this._state=DC.OverlayState.REMOVED)}},{key:"setStyle",value:function(e){}},{key:"remove",value:function(){this._layer&&this._layer.removeOverlay(this)}},{key:"addToLayer",value:function(e){e&&e.addOverlay(this)}},{key:"on",value:function(e,t,n){return this._overlayEvent.on(e,t,n||this),this}},{key:"off",value:function(e,t,n){return this._overlayEvent.off(e,t,n||this),this}},{key:"fire",value:function(e,t){return this._overlayEvent.fire(e,t),this}},{key:"id",get:function(){return this._id}},{key:"show",set:function(e){this._show=e,this._delegate&&(this._delegate.show=this._show)},get:function(){return this._show}},{key:"attr",set:function(e){this._attr=e},get:function(){return this._attr}},{key:"overlayEvent",get:function(){return this._overlayEvent}},{key:"delegate",get:function(){return this._delegate}},{key:"state",get:function(){return this._state}}])&&Tn(t.prototype,n),r&&Tn(t,r),e}();function jn(e){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function An(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?An(Object(n),!0).forEach((function(t){Mn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):An(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function In(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ln(e,t){return!t||"object"!==jn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rn(e){return(Rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wn(e,t){return(Wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fn(e){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nn(e,t){return!t||"object"!==Fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qn(e){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hn(e,t){return(Hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Un(e){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){Jn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qn(e,t){return!t||"object"!==Un(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $n(e){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function er(e,t){return(er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tr(e){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rr(e,t){return!t||"object"!==tr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ir(e){return(ir=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function or(e,t){return(or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ar(e){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lr(e,t){return!t||"object"!==ar(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cr(e){return(cr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ur(e,t){return(ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fr(e){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dr(e,t){return!t||"object"!==fr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _r(e){return(_r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mr(e,t){return(mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.Billboard=function(e){function t(e,n){var i;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!(e&&e instanceof DC.Position))throw new Error("the position invalid");return(i=Ln(this,Rn(t).call(this)))._position=e,i._icon=n,i._size=[32,32],i._delegate=new r.Entity,i._state=DC.OverlayState.INITIALIZED,i.type=DC.OverlayType.BILLBOARD,i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wn(e,t)}(t,e),n=t,o=[{key:"fromEntity",value:function(e){var t=DC.T.transformCartesianToWSG84(e.position._value),n=void 0;return e.billboard&&((n=new DC.Billboard(t,e.billboard.image)).attr=zn({},e.properties)),n}}],(i=[{key:"_prepareDelegate",value:function(){var e=this;this._delegate.position=new r.CallbackProperty((function(t){return DC.T.transformWSG84ToCartesian(e._position)})),this._delegate.orientation=new r.CallbackProperty((function(t){return r.Transforms.headingPitchRollQuaternion(DC.T.transformWSG84ToCartesian(e._position),new r.HeadingPitchRoll(r.Math.toRadians(e._position.heading),r.Math.toRadians(e._position.pitch),r.Math.toRadians(e._position.roll)))})),this._delegate.billboard=zn({},this._style,{image:new r.CallbackProperty((function(t){return e._icon})),width:new r.CallbackProperty((function(t){return e._size[0]||32})),height:new r.CallbackProperty((function(t){return e._size[1]||32}))}),this._delegate.layer=this._layer,this._delegate.overlayId=this._id}},{key:"setLabel",value:function(e,t){return this._delegate.label=zn({},t,{text:e}),this}},{key:"setStyle",value:function(e){return 0===Object.keys(e).length?this:(this._style=e,this._delegate.billboard&&DC.Util.merge(this._delegate.billboard,this._style),this)}},{key:"position",set:function(e){this._position=e},get:function(){return this._position}},{key:"icon",set:function(e){this._icon=e},get:function(){return this._icon}},{key:"size",set:function(e){this._size=e},get:function(){return this._size}}])&&In(n.prototype,i),o&&In(n,o),t}(Sn),DC.OverlayType.BILLBOARD="billboard",DC.CustomBillboard=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Nn(this,qn(t).call(this,e,n)))._state=DC.OverlayState.INITIALIZED,r.type=DC.OverlayType.CUSTOM_BILLBOARD,r}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hn(e,t)}(t,DC.Billboard),n=t,(i=[{key:"setLine",value:function(e){var t=this;if(this._position&&this._position.alt>0&&this._delegate){if(!this._delegate.polyline){var n=new DC.Position;this._delegate.polyline={positions:new r.CallbackProperty((function(e){return n.lng=t._position.lng,n.lat=t._position.lat,n.alt=0,DC.T.transformWSG84ArrayToCartesianArray([n,t._position])}))}}this._delegate.polyline&&this._delegate.polyline.merge(e)}return this}},{key:"setCircle",value:function(e,t){return!this._delegate.ellipse&&(this._delegate.ellipse={}),this._delegate.ellipse.merge(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(n),!0).forEach((function(t){Bn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({semiMajorAxis:e,semiMinorAxis:e},t)),this}}])&&Gn(n.prototype,i),o&&Gn(n,o),t}(),DC.OverlayType.CUSTOM_BILLBOARD="customBillboard",DC.Polygon=function(e){function t(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!e||"string"!=typeof e&&!Array.isArray(e))throw new Error("the positions invalid");return(n=Qn(this,$n(t).call(this)))._positions=n._preparePositions(e),n._holes=[],n._delegate=new r.Entity,n._state=DC.OverlayState.INITIALIZED,n.type=DC.OverlayType.POLYGON,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&er(e,t)}(t,e),n=t,o=[{key:"fromEntity",value:function(e){var t=void 0;if(e.polygon){var n=DC.T.transformCartesianArrayToWSG84Array(item.polygon.hierarchy.getValue(r.JulianDate.now()).positions);(t=new DC.Polygon(n)).attr=Yn({},e.properties)}return t}}],(i=[{key:"_preparePositions",value:function(e){if("string"==typeof e){if(e.indexOf("#")>=0)throw new Error("the positions invalid");e=e.split(";")}return e.map((function(e){return Array.isArray(e)?DC.Position.fromCoordArray(e):e instanceof DC.Position?e:DC.Position.fromCoordString(e)}))}},{key:"_prepareHierarchy",value:function(){var e=new r.PolygonHierarchy;return e.positions=DC.T.transformWSG84ArrayToCartesianArray(this._positions),e.holes=this._holes.map((function(e){return new r.PolygonHierarchy(DC.T.transformWSG84ArrayToCartesianArray(e))})),e}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.polygon=Yn({},this._style,{hierarchy:new r.CallbackProperty((function(t){return e._prepareHierarchy()}))}),this._delegate.layer=this._layer,this._delegate.overlayId=this._id}},{key:"setStyle",value:function(e){return e&&0!==Object.keys(e).length?(this._style=e,this._delegate.polygon&&DC.Util.merge(this._delegate.polygon,this._style),this):this}},{key:"positions",set:function(e){this._positions=this._preparePositions(e)},get:function(){return this._positions}},{key:"holes",set:function(e){var t=this;e&&e.length&&(this._holes=e.map((function(e){return t._preparePositions(e)})))},get:function(){return this._holes}},{key:"center",get:function(){var e=r.BoundingSphere.fromPoints(DC.T.transformWSG84ArrayToCartesianArray(this._positions));return DC.T.transformCartesianToWSG84(e.center)}},{key:"area",get:function(){var e=0;if(this._positions){var t=0,n=r.Ellipsoid.WGS84,i=Zn(this._positions);i.push(i[0]);for(var o=1;o<i.length;o++){var a=n.cartographicToCartesian(DC.T.transformWSG84ToCartographic(i[o-1])),s=n.cartographicToCartesian(DC.T.transformWSG84ToCartographic(i[o]));t+=a.x*s.y-s.x*a.y}e=Math.abs(t).toFixed(2)}return e}}])&&Xn(n.prototype,i),o&&Xn(n,o),t}(Sn),DC.OverlayType.POLYGON="polygon",DC.CustomPolygon=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=rr(this,ir(t).call(this,e)))._topOutline=void 0,n._bottomOutline=void 0,n._topOutline=new r.Entity({polyline:{positions:n._computePolylinePositions(0)},show:!1}),n._bottomOutline=new r.Entity({polyline:{positions:n._computePolylinePositions(0)},show:!1}),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&or(e,t)}(t,DC.Polygon),n=t,(i=[{key:"_computePolylinePositions",value:function(e){var t=this._positions.slice(0);return t.push(t[0]),t.forEach((function(t){t.alt=e})),DC.T.transformWSG84ArrayToCartesianArray(t)}},{key:"_addCallback",value:function(e){this._layer=e,this._prepareDelegate(),this._layer&&this._layer.delegate&&this._layer.delegate.entities&&(this._layer.delegate.entities.add(this._delegate),this._layer.delegate.entities.add(this._topOutline),this._layer.delegate.entities.add(this._bottomOutline),this._state=DC.OverlayState.ADDED)}},{key:"_removeCallback",value:function(){this._layer&&this._layer.delegate&&this._layer.delegate.entities&&(this._layer.delegate.entities.remove(this._delegate),this._layer.delegate.entities.remove(this._topOutline),this._layer.delegate.entities.remove(this._bottomOutline),this._state=DC.OverlayState.REMOVED)}},{key:"setExtrudedHeight",value:function(e){var t=this;return arguments.length>1&&void 0!==arguments[1]&&arguments[1],this._delegate.polygon&&(this._delegate.polygon.extrudedHeight=new r.CallbackProperty((function(t){return e})),this._topOutline&&this._topOutline.show&&(this._topOutline.polyline.positions=new r.CallbackProperty((function(n){return t._computePolylinePositions(e)})))),this}},{key:"setTopOutline",value:function(e){if(this._topOutline){if(this._topOutline.show=r.defaultValue(e.show,!0),delete e.show,!e||0===Object.keys(e).length)return this;DC.Util.merge(this._topOutline.polyline,e)}return this}},{key:"setBottomOutline",value:function(e){if(this._bottomOutline){if(this._bottomOutline.show=r.defaultValue(e.show,!0),delete e.show,!e||0===Object.keys(e).length)return this;DC.Util.merge(this._bottomOutline.polyline,e)}return this}},{key:"show",set:function(e){this._show=e,this._delegate&&(this._delegate.show=e),this._topOutline&&(this._topOutline.show=e),this._bottomOutline&&(this._bottomOutline.show=e)},get:function(){return this._show}}])&&nr(n.prototype,i),o&&nr(n,o),t}(),DC.DivIcon=function(e){function t(e,n){var r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!(e&&e instanceof DC.Position))throw new Error("the position invalid");return(r=lr(this,cr(t).call(this)))._position=e,r._delegate=DC.DomUtil.create("div","div-icon"),r._delegate.setAttribute("id",r._id),r._delegate.style.position="absolute",r._delegate.style.top="0",r._delegate.style.left="0",n&&"string"==typeof n?r._delegate.innerHTML=n:n&&n instanceof Element&&r._delegate.appendChild(n),r._state=DC.OverlayState.INITIALIZED,r.type=DC.OverlayType.DIVICON,r}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ur(e,t)}(t,e),n=t,(r=[{key:"_updateWindowCoord",value:function(e){var t=e.x-this._delegate.offsetWidth/2,n=e.y-this._delegate.offsetHeight/2;this._delegate.style.transform="translate3d(".concat(Math.round(t),"px,").concat(Math.round(n),"px, 0)")}},{key:"_addCallback",value:function(e){var t=this;this._layer=e,this._layer.delegate.appendChild(this._delegate),this._delegate.addEventListener("click",(function(n){t._overlayEvent.fire(DC.MouseEventType.CLICK,{layer:e,overlay:t,position:DC.T.transformWSG84ToCartesian(t._position)})})),this._state=DC.OverlayState.ADDED}},{key:"_removeCallback",value:function(){this._layer&&(this._layer.delegate.removeChild(this._delegate),this._overlayEvent(),this._state=DC.OverlayState.REMOVED)}},{key:"addClass",value:function(e){return DC.DomUtil.addClass(this._delegate,e),this}},{key:"show",set:function(e){this._show=e,this._delegate.style.visibility=this._show?"visible":"hidden"},get:function(){return this._show}},{key:"position",set:function(e){this._position=e},get:function(){return this._position}}])&&sr(n.prototype,r),i&&sr(n,i),t}(Sn),DC.OverlayType.DIVICON="divICon",DC.Wall=function(e){function t(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!e||"string"!=typeof e&&!Array.isArray(e))throw new Error("the positions invalid");return(n=dr(this,_r(t).call(this)))._positions=[],n._preparePositions(e),n._delegate=new r.Entity,n._state=DC.OverlayState.INITIALIZED,n.type=DC.OverlayType.WALL,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mr(e,t)}(t,e),n=t,(i=[{key:"_preparePositions",value:function(e){if("string"==typeof e){if(e.indexOf("#")>=0)throw new Error("the positions invalid");e=e.split(";")}this._positions=e.map((function(e){return Array.isArray(e)?DC.Position.fromCoordArray(e):e instanceof DC.Position?e:DC.Position.fromCoordString(e)}))}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.wall=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(n),!0).forEach((function(t){hr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this._style,{positions:new r.CallbackProperty((function(t){return DC.T.transformWSG84ArrayToCartesianArray(e._positions)}))}),this._delegate.layer=this._layer,this._delegate.overlayId=this._id}},{key:"setStyle",value:function(e){return 0==Object.keys(e).length?this:(this._style=e,this._delegate.wall&&DC.Util.merge(this._delegate.wall,this._style),this)}},{key:"positions",set:function(e){this._preparePositions(e)},get:function(){return this._positions}}])&&yr(n.prototype,i),o&&yr(n,o),t}(Sn),DC.OverlayType.WALL="wall"}]);